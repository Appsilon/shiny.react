<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shiny.react">
<title>Tutorial: Porting Liquid Oxygen to Shiny • shiny.react</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Tutorial: Porting Liquid Oxygen to Shiny">
<meta property="og:description" content="shiny.react">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PPRNFWFZBQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PPRNFWFZBQ');
</script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-FQQZL5V93G"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FQQZL5V93G');
</script><script async defer src="https://buttons.github.io/buttons.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shiny.react</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/shiny-react.html">Tutorial</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Appsilon/shiny.react">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/Appsilon">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="shiny-react_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial: Porting Liquid Oxygen to Shiny</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Appsilon/shiny.react/blob/HEAD/vignettes/shiny-react.Rmd" class="external-link"><code>vignettes/shiny-react.Rmd</code></a></small>
      <div class="d-none name"><code>shiny-react.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p><a href="https://emdgroup-liquid.github.io/liquid/" class="external-link">Liquid Oxygen</a> is a UI component library based on the Liquid Design System, focusing on accessibility and interoperability. It provides React bindings and as such can be ported to Shiny through <code>shiny.react</code>. It is similar in concept to Microsoft’s <a href="https://developer.microsoft.com/en-us/fluentui#/" class="external-link">Fluent UI</a> or Google’s <a href="https://mui.com/core/" class="external-link">MUI</a>.</p>
<p>In this tutorial we will (begin to) create a <code>liquid</code> R package, which will make it possible to use Liquid Oxygen in R/Shiny akin to how <a href="https://github.com/Appsilon/shiny.fluent" class="external-link">shiny.fluent</a> does it for Fluent UI. It should give you enough understanding of shiny.react to allow you to use other React libraries in your projects, either by creating “wrapper” R packages or directly in you Shiny app.</p>
<p>This tutorial is aimed at advanced users who feel comfortable with both Shiny and React. You will need R and <a href="https://nodejs.org/en/" class="external-link">Node.js</a> installed.</p>
</div>
<div class="section level3">
<h3 id="creating-the-package">Creating the package<a class="anchor" aria-label="anchor" href="#creating-the-package"></a>
</h3>
<p>To start off we create a new package called liquid. The <code>js</code> directory will contain the Node.js toolchain and JavaScript sources which will be compiled into a single file. Only that file will be needed to use the package, so we add <code>js</code> to <code>.Rbuildignore</code> to decrease the size of our package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">create_package</span><span class="op">(</span><span class="st">"liquid"</span><span class="op">)</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">use_build_ignore</span><span class="op">(</span><span class="st">"js"</span><span class="op">)</span></span></code></pre></div>
<p>It is also a good idea to list the dependencies in the <code>DESCRIPTION</code> file:</p>
<pre><code>Imports:
  htmltools,
  shiny,
  shiny.react</code></pre>
</div>
<div class="section level3">
<h3 id="the-r-interface">The R interface<a class="anchor" aria-label="anchor" href="#the-r-interface"></a>
</h3>
<p>In React, a <a href="https://reactjs.org/docs/glossary.html#components" class="external-link">component</a> is a function which takes <a href="https://reactjs.org/docs/glossary.html#props" class="external-link">props</a> and returns an <a href="https://reactjs.org/docs/glossary.html#elements" class="external-link">element</a>. These concepts map to R directly.</p>
<p>In R, elements are created with <code>shiny.react::reactElement(module, name, props)</code>. In the browser, shiny.react will create the element by calling <code>React.createElement(jsmodule[module][name], props)</code>. It is our task to ensure that <code>jsmodule[module][name]</code> yields the right component. To accomplish it, we will later create a <code>liquid.js</code> script which will set up the <code>jsmodule</code> global appropriately.</p>
<p>To free the users of our package of having to include this script manually, we will use an HTML dependency. In <code>R/components.R</code> let’s define:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">liquidDependency</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/htmlDependency.html" class="external-link">htmlDependency</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"liquid"</span>,</span>
<span>    version <span class="op">=</span> <span class="st">"0.1.0"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"liquid"</span>,</span>
<span>    src <span class="op">=</span> <span class="st">"www"</span>,</span>
<span>    script <span class="op">=</span> <span class="st">"liquid.js"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To define components succinctly, let’s create a helper. Remember - components are functions which take props and return elements:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">component</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu">shiny.react</span><span class="fu">::</span><span class="fu"><a href="../reference/reactElement.html">reactElement</a></span><span class="op">(</span></span>
<span>    module <span class="op">=</span> <span class="st">"@emdgroup-liquid/liquid"</span>,</span>
<span>    name <span class="op">=</span> <span class="va">name</span>,</span>
<span>    props <span class="op">=</span> <span class="fu">shiny.react</span><span class="fu">::</span><span class="fu"><a href="../reference/asProps.html">asProps</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>    deps <span class="op">=</span> <span class="fu">liquidDependency</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can now add Liquid components to our package easily! Let’s try a <a href="https://emdgroup-liquid.github.io/liquid/components/ld-button/" class="external-link">LdButton</a> and a <a href="https://emdgroup-liquid.github.io/liquid/components/ld-loading/" class="external-link">LdLoading</a> for starters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @export</span></span>
<span><span class="va">LdButton</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"LdButton"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">LdLoading</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"LdLoading"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-liquid">Adding Liquid<a class="anchor" aria-label="anchor" href="#adding-liquid"></a>
</h3>
<p>In the <code>js</code> directory we use <code>yarn</code> to add the Liquid Oxygen library.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ex">yarn</span> init --yes</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="ex">yarn</span> add @emdgroup-liquid/liquid@3.0.0</span></code></pre></div>
<p>In order to use react components we need to find where package exports are defined first. We need to look for export keyword with names of components. In case of this package, exports can be found in <code>@emdgroup-liquid/liquid/dist/react</code>.</p>
<p>We will use a bundler to generate the <code>liquid.js</code> script from the following <code>js/src/index.js</code> file:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">const</span> Liquid <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@emdgroup-liquid/liquid/dist/react'</span>)<span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="pp">require</span>(<span class="st">'@emdgroup-liquid/liquid/dist/css/liquid.css'</span>)<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="bu">window</span><span class="op">.</span><span class="at">jsmodule</span> <span class="op">=</span> {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>  <span class="op">...</span><span class="bu">window</span><span class="op">.</span><span class="at">jsmodule</span><span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>  <span class="st">'@emdgroup-liquid/liquid'</span><span class="op">:</span> Liquid</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>}<span class="op">;</span></span></code></pre></div>
<p>This script will make the Liquid Oxygen library available as <code>jsmodule[@emdgroup-liquid/liquid]</code> on the browser. It will also load the necessary CSS.</p>
</div>
<div class="section level3">
<h3 id="bundling">Bundling<a class="anchor" aria-label="anchor" href="#bundling"></a>
</h3>
<p>We will use <a href="https://webpack.js.org/" class="external-link">webpack</a> to build the <code>liquid.js</code> file.</p>
<p>There is a handy <a href="https://createapp.dev/webpack" class="external-link">online tool</a> which we can use to generate a configuration for that webpack. Let’s just pick CSS from the Styling section and copy the the script to <code>js/webpack.config.js</code>. We also add dev dependencies as suggested by the tool:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="ex">yarn</span> add --dev webpack webpack-cli css-loader style-loader</span></code></pre></div>
<p>Now let’s tweak the config a bit. We change the output to <code>inst/www/liquid.js</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>output<span class="op">:</span> {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>  <span class="dt">path</span><span class="op">:</span> path<span class="op">.</span><span class="fu">join</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">'..'</span><span class="op">,</span> <span class="st">'inst'</span><span class="op">,</span> <span class="st">'www'</span>)<span class="op">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>  <span class="dt">filename</span><span class="op">:</span> <span class="st">'liquid.js'</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>We add <a href="https://webpack.js.org/configuration/externals/" class="external-link"><code>externals</code></a> to let webpack know where to look for modules provided by shiny.react:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>externals<span class="op">:</span> {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>  <span class="st">'react'</span><span class="op">:</span> <span class="st">'jsmodule["react"]'</span><span class="op">,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>  <span class="st">'react-dom'</span><span class="op">:</span> <span class="st">'jsmodule["react-dom"]'</span><span class="op">,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>  <span class="st">'@/shiny.react'</span><span class="op">:</span> <span class="st">'jsmodule["@/shiny.react"]'</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Our final <code>js/webpack.config.js</code> looks as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="kw">const</span> webpack <span class="op">=</span> <span class="pp">require</span>(<span class="st">'webpack'</span>)<span class="op">;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="kw">const</span> path <span class="op">=</span> <span class="pp">require</span>(<span class="st">'path'</span>)<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="kw">const</span> config <span class="op">=</span> {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>  <span class="dt">entry</span><span class="op">:</span> <span class="st">'./src/index.js'</span><span class="op">,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  <span class="dt">output</span><span class="op">:</span> {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>    <span class="dt">path</span><span class="op">:</span> path<span class="op">.</span><span class="fu">join</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">'..'</span><span class="op">,</span> <span class="st">'inst'</span><span class="op">,</span> <span class="st">'www'</span>)<span class="op">,</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>    <span class="dt">filename</span><span class="op">:</span> <span class="st">'liquid.js'</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>  }<span class="op">,</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>  <span class="dt">module</span><span class="op">:</span> {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>    <span class="dt">rules</span><span class="op">:</span> [</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>      {</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>        <span class="dt">test</span><span class="op">:</span> <span class="ss">/</span><span class="sc">\.</span><span class="ss">css</span><span class="sc">$</span><span class="ss">/</span><span class="op">,</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>        <span class="dt">use</span><span class="op">:</span> [</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>          <span class="st">'style-loader'</span><span class="op">,</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>          <span class="st">'css-loader'</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>        ]</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>      }</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>    ]</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>  }<span class="op">,</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>  <span class="dt">externals</span><span class="op">:</span> {</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>    <span class="st">'react'</span><span class="op">:</span> <span class="st">'jsmodule["react"]'</span><span class="op">,</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>    <span class="st">'react-dom'</span><span class="op">:</span> <span class="st">'jsmodule["react-dom"]'</span><span class="op">,</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>    <span class="st">'@/shiny.react'</span><span class="op">:</span> <span class="st">'jsmodule["@/shiny.react"]'</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>  }</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>}<span class="op">;</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> config<span class="op">;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="building-the-package">Building the package<a class="anchor" aria-label="anchor" href="#building-the-package"></a>
</h3>
<p>We are ready to build our package! First of all, we run webpack in the <code>js</code> directory:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="ex">yarn</span> webpack</span></code></pre></div>
<p>This will generate the <code>inst/www/webpack.js</code> bundle. We should also generate the NAMESPACE file:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can now install the package directly with <code>devtools::install()</code> and try it out!</p>
</div>
<div class="section level3">
<h3 id="using-the-package">Using the package<a class="anchor" aria-label="anchor" href="#using-the-package"></a>
</h3>
<p>Let’s try a simple app first to test our components:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://appsilon.github.io/shiny.react/">shiny.react</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">liquid</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu">LdButton</span><span class="op">(</span><span class="st">"Test Button"</span><span class="op">)</span>,</span>
<span>    <span class="fu">LdLoading</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Cool! Let’s try something more advanced:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu">LdButton</span><span class="op">(</span></span>
<span>      <span class="st">"Initiate loading"</span>,</span>
<span>      onClick <span class="op">=</span> <span class="fu"><a href="../reference/JS.html">JS</a></span><span class="op">(</span><span class="st">"(event) =&gt; Shiny.setInputValue('loading', true)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/reactOutput.html">reactOutput</a></span><span class="op">(</span><span class="st">"spinner"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">spinner</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/renderReact.html">renderReact</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">loading</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">input</span><span class="op">$</span><span class="va">loading</span><span class="op">)</span> <span class="fu">LdLoading</span><span class="op">(</span><span class="op">)</span> <span class="kw">else</span> <span class="cn">NULL</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-input-wrappers">Creating input wrappers<a class="anchor" aria-label="anchor" href="#creating-input-wrappers"></a>
</h3>
<p>Even simple components can be cumbersome to use in Shiny, as evident in the last example. It is a good idea to create <code>.shinyInput</code> wrappers to simplify the life of your users.</p>
<p>We change our <code>js/src/index.js</code> to the following:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">const</span> Liquid <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@emdgroup-liquid/liquid/dist/react'</span>)<span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="kw">const</span> { InputAdapter } <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@/shiny.react'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="pp">require</span>(<span class="st">'@emdgroup-liquid/liquid/dist/css/liquid.css'</span>)<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="kw">const</span> LdSelect <span class="op">=</span> <span class="fu">InputAdapter</span>(Liquid<span class="op">.</span><span class="at">LdSelect</span><span class="op">,</span> (value<span class="op">,</span> setValue) <span class="kw">=&gt;</span> ({</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>  <span class="dt">onLdchange</span><span class="op">:</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>    <span class="fu">setValue</span>(<span class="bu">event</span><span class="op">.</span><span class="at">detail</span>)<span class="op">;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>  }<span class="op">,</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>}))<span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a><span class="bu">window</span><span class="op">.</span><span class="at">jsmodule</span> <span class="op">=</span> {</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a>  <span class="op">...</span><span class="bu">window</span><span class="op">.</span><span class="at">jsmodule</span><span class="op">,</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>  <span class="st">'@emdgroup-liquid/liquid'</span><span class="op">:</span> Liquid<span class="op">,</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>  <span class="st">'@/liquid'</span><span class="op">:</span> { LdSelect }</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>}<span class="op">;</span></span></code></pre></div>
<p>In order to create an input that can be used in Shiny server we need to create the component with a hook that will set a value of Shiny input. We can use <code>InputAdapter</code> from <code>shiny.react</code> package to do it easily.</p>
<p>The documentation states that Liquid components dispatch ldchange events, to change value of Shiny input we need to set a value when component changes its state. For React components we use onLdchange prop and we set the value using event.detail. This property contains an array of selected items from the dropdown. If the documentation provides information which event field contains value of input use the one from documentation. If it doesn’t you can set a breakpoint in the browser to investigate what fields does event object have and use the appropriate one.</p>
<p>We also add these lines to <code>R/components.R</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">defaultValue</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">...</span>, <span class="va">value</span> <span class="op">=</span> <span class="va">defaultValue</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">shiny.react</span><span class="fu">::</span><span class="fu"><a href="../reference/reactElement.html">reactElement</a></span><span class="op">(</span></span>
<span>      module <span class="op">=</span> <span class="st">"@/liquid"</span>,</span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      props <span class="op">=</span> <span class="fu">shiny.react</span><span class="fu">::</span><span class="fu"><a href="../reference/asProps.html">asProps</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="va">inputId</span>, <span class="va">...</span>, value <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>      deps <span class="op">=</span> <span class="fu">liquidDependency</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">LdOption</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"LdOption"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">LdSelect.shinyInput</span> <span class="op">&lt;-</span> <span class="fu">input</span><span class="op">(</span><span class="st">"LdSelect"</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">LdSelect</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"LdSelect"</span><span class="op">)</span></span></code></pre></div>
<p>After rebuilding and reinstalling the package we can now rewrite the last Shiny app example as:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu">LdSelect.shinyInput</span><span class="op">(</span></span>
<span>      placeholder <span class="op">=</span> <span class="st">"Pick a fruit"</span>,</span>
<span>      inputId <span class="op">=</span> <span class="st">"fruit"</span>,</span>
<span>      value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      <span class="fu">LdOption</span><span class="op">(</span><span class="st">"Apple"</span><span class="op">)</span>,</span>
<span>      <span class="fu">LdOption</span><span class="op">(</span><span class="st">"Orange"</span><span class="op">)</span>,</span>
<span>      <span class="fu">LdOption</span><span class="op">(</span><span class="st">"Strawberry"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"selectedFruit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">selectedFruit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">input</span><span class="op">$</span><span class="va">fruit</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<p>The module name passed to <code>shiny.react::createElement()</code> can be arbitrary, but the following convention is recommended:</p>
<ul>
<li>For modules coming directly from <a href="https://www.npmjs.com/" class="external-link">npm</a>, use the npm name, e.g. <a href="https://www.npmjs.com/package/@emdgroup-liquid/liquid" class="external-link"><code>@emdgroup-liquid/liquid</code></a>.</li>
<li>For modules with custom code, use the R package name with <code>@/</code> prefix, e.g. <code>@/liquid</code>.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed with <span class="emoji" data-emoji="heart">❤️</span> by <a href="https://appsilon.com" class="external-link">Appsilon</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
